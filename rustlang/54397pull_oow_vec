===buggy code===
let mut buf = Vec::with_capacity(self.len() * n);

===bug fix===
let mut buf = Vec::with_capacity(self.len().checked_mul(n).expect("capacity overflow"));

===ref===
https://github.com/rust-lang/rust/pull/54397

===security===
yes

===unsafe nested===
yes
